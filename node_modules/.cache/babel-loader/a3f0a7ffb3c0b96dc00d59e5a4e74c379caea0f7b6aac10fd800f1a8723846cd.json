{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nvar _excluded = [\"name\", \"escapedValue\", \"data\", \"path\"];\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nimport { checkRendering, warning, createDocumentationMessageGenerator, createSendEventForFacet, isEqual, noop } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'hierarchical-menu',\n  connector: true\n});\nvar DEFAULT_SORT = ['name:asc'];\n/**\n * **HierarchicalMenu** connector provides the logic to build a custom widget\n * that will give the user the ability to explore facets in a tree-like structure.\n *\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two\n * levels deep.\n *\n * @type {Connector}\n * @param {function(HierarchicalMenuRenderingOptions, boolean)} renderFn Rendering function for the custom **HierarchicalMenu** widget.\n * @param {function} unmountFn Unmount function called when the widget is disposed.\n * @return {function(CustomHierarchicalMenuWidgetParams)} Re-usable widget factory for a custom **HierarchicalMenu** widget.\n */\nvar connectHierarchicalMenu = function connectHierarchicalMenu(renderFn) {\n  var unmountFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n  checkRendering(renderFn, withUsage());\n  return function (widgetParams) {\n    var _ref = widgetParams || {},\n      attributes = _ref.attributes,\n      _ref$separator = _ref.separator,\n      separator = _ref$separator === void 0 ? ' > ' : _ref$separator,\n      _ref$rootPath = _ref.rootPath,\n      rootPath = _ref$rootPath === void 0 ? null : _ref$rootPath,\n      _ref$showParentLevel = _ref.showParentLevel,\n      showParentLevel = _ref$showParentLevel === void 0 ? true : _ref$showParentLevel,\n      _ref$limit = _ref.limit,\n      limit = _ref$limit === void 0 ? 10 : _ref$limit,\n      _ref$showMore = _ref.showMore,\n      showMore = _ref$showMore === void 0 ? false : _ref$showMore,\n      _ref$showMoreLimit = _ref.showMoreLimit,\n      showMoreLimit = _ref$showMoreLimit === void 0 ? 20 : _ref$showMoreLimit,\n      _ref$sortBy = _ref.sortBy,\n      sortBy = _ref$sortBy === void 0 ? DEFAULT_SORT : _ref$sortBy,\n      _ref$transformItems = _ref.transformItems,\n      transformItems = _ref$transformItems === void 0 ? function (items) {\n        return items;\n      } : _ref$transformItems;\n    if (!attributes || !Array.isArray(attributes) || attributes.length === 0) {\n      throw new Error(withUsage('The `attributes` option expects an array of strings.'));\n    }\n    if (showMore === true && showMoreLimit <= limit) {\n      throw new Error(withUsage('The `showMoreLimit` option must be greater than `limit`.'));\n    }\n    // we need to provide a hierarchicalFacet name for the search state\n    // so that we can always map $hierarchicalFacetName => real attributes\n    // we use the first attribute name\n    var _attributes = _slicedToArray(attributes, 1),\n      hierarchicalFacetName = _attributes[0];\n    var sendEvent;\n\n    // Provide the same function to the `renderFn` so that way the user\n    // has to only bind it once when `isFirstRendering` for instance\n    var toggleShowMore = function toggleShowMore() {};\n    function cachedToggleShowMore() {\n      toggleShowMore();\n    }\n    var _refine;\n    var isShowingMore = false;\n    function createToggleShowMore(renderOptions, widget) {\n      return function () {\n        isShowingMore = !isShowingMore;\n        widget.render(renderOptions);\n      };\n    }\n    function getLimit() {\n      return isShowingMore ? showMoreLimit : limit;\n    }\n    function _prepareFacetValues(facetValues) {\n      return facetValues.slice(0, getLimit()).map(function (_ref2) {\n        var label = _ref2.name,\n          value = _ref2.escapedValue,\n          data = _ref2.data,\n          path = _ref2.path,\n          subValue = _objectWithoutProperties(_ref2, _excluded);\n        var item = _objectSpread(_objectSpread({}, subValue), {}, {\n          value: value,\n          label: label,\n          data: null\n        });\n        if (Array.isArray(data)) {\n          item.data = _prepareFacetValues(data);\n        }\n        return item;\n      });\n    }\n    return {\n      $$type: 'ais.hierarchicalMenu',\n      init: function init(initOptions) {\n        var instantSearchInstance = initOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(initOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), true);\n      },\n      render: function render(renderOptions) {\n        var instantSearchInstance = renderOptions.instantSearchInstance;\n        toggleShowMore = createToggleShowMore(renderOptions, this);\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(renderOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), false);\n      },\n      dispose: function dispose(_ref3) {\n        var state = _ref3.state;\n        unmountFn();\n        return state.removeHierarchicalFacet(hierarchicalFacetName).setQueryParameter('maxValuesPerFacet', undefined);\n      },\n      getRenderState: function getRenderState(renderState, renderOptions) {\n        return _objectSpread(_objectSpread({}, renderState), {}, {\n          hierarchicalMenu: _objectSpread(_objectSpread({}, renderState.hierarchicalMenu), {}, _defineProperty({}, hierarchicalFacetName, this.getWidgetRenderState(renderOptions)))\n        });\n      },\n      getWidgetRenderState: function getWidgetRenderState(_ref4) {\n        var _this = this;\n        var results = _ref4.results,\n          state = _ref4.state,\n          createURL = _ref4.createURL,\n          instantSearchInstance = _ref4.instantSearchInstance,\n          helper = _ref4.helper;\n        var items = [];\n        var canToggleShowMore = false;\n\n        // Bind createURL to this specific attribute\n        var _createURL = function _createURL(facetValue) {\n          return createURL(function (uiState) {\n            return _this.getWidgetUiState(uiState, {\n              searchParameters: state.resetPage().toggleFacetRefinement(hierarchicalFacetName, facetValue),\n              helper: helper\n            });\n          });\n        };\n        if (!sendEvent) {\n          sendEvent = createSendEventForFacet({\n            instantSearchInstance: instantSearchInstance,\n            helper: helper,\n            attribute: function attribute(facetValue) {\n              var index = facetValue.split(separator).length - 1;\n              return attributes[index];\n            },\n            widgetType: this.$$type\n          });\n        }\n        if (!_refine) {\n          _refine = function _refine(facetValue) {\n            sendEvent('click:internal', facetValue);\n            helper.toggleFacetRefinement(hierarchicalFacetName, facetValue).search();\n          };\n        }\n        if (results) {\n          var facetValues = results.getFacetValues(hierarchicalFacetName, {\n            sortBy: sortBy,\n            facetOrdering: sortBy === DEFAULT_SORT\n          });\n          var facetItems = facetValues && !Array.isArray(facetValues) && facetValues.data ? facetValues.data : [];\n\n          // If the limit is the max number of facet retrieved it is impossible to know\n          // if the facets are exhaustive. The only moment we are sure it is exhaustive\n          // is when it is strictly under the number requested unless we know that another\n          // widget has requested more values (maxValuesPerFacet > getLimit()).\n          // Because this is used for making the search of facets unable or not, it is important\n          // to be conservative here.\n          var hasExhaustiveItems = (state.maxValuesPerFacet || 0) > getLimit() ? facetItems.length <= getLimit() : facetItems.length < getLimit();\n          canToggleShowMore = showMore && (isShowingMore || !hasExhaustiveItems);\n          items = transformItems(_prepareFacetValues(facetItems), {\n            results: results\n          });\n        }\n        return {\n          items: items,\n          refine: _refine,\n          canRefine: items.length > 0,\n          createURL: _createURL,\n          sendEvent: sendEvent,\n          widgetParams: widgetParams,\n          isShowingMore: isShowingMore,\n          toggleShowMore: cachedToggleShowMore,\n          canToggleShowMore: canToggleShowMore\n        };\n      },\n      getWidgetUiState: function getWidgetUiState(uiState, _ref5) {\n        var searchParameters = _ref5.searchParameters;\n        var path = searchParameters.getHierarchicalFacetBreadcrumb(hierarchicalFacetName);\n        return removeEmptyRefinementsFromUiState(_objectSpread(_objectSpread({}, uiState), {}, {\n          hierarchicalMenu: _objectSpread(_objectSpread({}, uiState.hierarchicalMenu), {}, _defineProperty({}, hierarchicalFacetName, path))\n        }), hierarchicalFacetName);\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n        var uiState = _ref6.uiState;\n        var values = uiState.hierarchicalMenu && uiState.hierarchicalMenu[hierarchicalFacetName];\n        if (searchParameters.isConjunctiveFacet(hierarchicalFacetName) || searchParameters.isDisjunctiveFacet(hierarchicalFacetName)) {\n          process.env.NODE_ENV === 'development' ? warning(false, \"HierarchicalMenu: Attribute \\\"\".concat(hierarchicalFacetName, \"\\\" is already used by another widget applying conjunctive or disjunctive faceting.\\nAs this is not supported, please make sure to remove this other widget or this HierarchicalMenu widget will not work at all.\")) : void 0;\n          return searchParameters;\n        }\n        if (searchParameters.isHierarchicalFacet(hierarchicalFacetName)) {\n          var facet = searchParameters.getHierarchicalFacetByName(hierarchicalFacetName);\n          process.env.NODE_ENV === 'development' ? warning(isEqual(facet.attributes, attributes) && facet.separator === separator && facet.rootPath === rootPath, 'Using Breadcrumb and HierarchicalMenu on the same facet with different options overrides the configuration of the HierarchicalMenu.') : void 0;\n        }\n        var withFacetConfiguration = searchParameters.removeHierarchicalFacet(hierarchicalFacetName).addHierarchicalFacet({\n          name: hierarchicalFacetName,\n          attributes: attributes,\n          separator: separator,\n          rootPath: rootPath,\n          showParentLevel: showParentLevel\n        });\n        var currentMaxValuesPerFacet = withFacetConfiguration.maxValuesPerFacet || 0;\n        var nextMaxValuesPerFacet = Math.max(currentMaxValuesPerFacet, showMore ? showMoreLimit : limit);\n        var withMaxValuesPerFacet = withFacetConfiguration.setQueryParameter('maxValuesPerFacet', nextMaxValuesPerFacet);\n        if (!values) {\n          return withMaxValuesPerFacet.setQueryParameters({\n            hierarchicalFacetsRefinements: _objectSpread(_objectSpread({}, withMaxValuesPerFacet.hierarchicalFacetsRefinements), {}, _defineProperty({}, hierarchicalFacetName, []))\n          });\n        }\n        return withMaxValuesPerFacet.addHierarchicalFacetRefinement(hierarchicalFacetName, values.join(separator));\n      }\n    };\n  };\n};\nfunction removeEmptyRefinementsFromUiState(indexUiState, attribute) {\n  if (!indexUiState.hierarchicalMenu) {\n    return indexUiState;\n  }\n  if (!indexUiState.hierarchicalMenu[attribute] || indexUiState.hierarchicalMenu[attribute].length === 0) {\n    delete indexUiState.hierarchicalMenu[attribute];\n  }\n  if (Object.keys(indexUiState.hierarchicalMenu).length === 0) {\n    delete indexUiState.hierarchicalMenu;\n  }\n  return indexUiState;\n}\nexport default connectHierarchicalMenu;","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_excluded","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","TypeError","Number","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","o","minLen","_arrayLikeToArray","n","toString","slice","name","Array","from","test","len","arr2","_i","_s","_e","_x","_r","_arr","_n","_d","next","done","err","return","isArray","checkRendering","warning","createDocumentationMessageGenerator","createSendEventForFacet","isEqual","noop","withUsage","connector","DEFAULT_SORT","connectHierarchicalMenu","renderFn","unmountFn","widgetParams","_ref","attributes","_ref$separator","separator","_ref$rootPath","rootPath","_ref$showParentLevel","showParentLevel","_ref$limit","limit","_ref$showMore","showMore","_ref$showMoreLimit","showMoreLimit","_ref$sortBy","sortBy","_ref$transformItems","transformItems","items","Error","_attributes","hierarchicalFacetName","sendEvent","toggleShowMore","cachedToggleShowMore","_refine","isShowingMore","createToggleShowMore","renderOptions","widget","render","getLimit","_prepareFacetValues","facetValues","map","_ref2","label","escapedValue","data","path","subValue","item","$$type","init","initOptions","instantSearchInstance","getWidgetRenderState","dispose","_ref3","state","removeHierarchicalFacet","setQueryParameter","getRenderState","renderState","hierarchicalMenu","_ref4","_this","results","createURL","helper","canToggleShowMore","_createURL","facetValue","uiState","getWidgetUiState","searchParameters","resetPage","toggleFacetRefinement","attribute","index","split","widgetType","search","getFacetValues","facetOrdering","facetItems","hasExhaustiveItems","maxValuesPerFacet","refine","canRefine","_ref5","getHierarchicalFacetBreadcrumb","removeEmptyRefinementsFromUiState","getWidgetSearchParameters","_ref6","values","isConjunctiveFacet","isDisjunctiveFacet","process","env","NODE_ENV","concat","isHierarchicalFacet","facet","getHierarchicalFacetByName","withFacetConfiguration","addHierarchicalFacet","currentMaxValuesPerFacet","nextMaxValuesPerFacet","Math","max","withMaxValuesPerFacet","setQueryParameters","hierarchicalFacetsRefinements","addHierarchicalFacetRefinement","join","indexUiState"],"sources":["C:/Users/Samue/OneDrive/Documents/University/Year 3/Computing Project/Code/RevisionWebApp/re-vision/node_modules/instantsearch.js/es/connectors/hierarchical-menu/connectHierarchicalMenu.js"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar _excluded = [\"name\", \"escapedValue\", \"data\", \"path\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { checkRendering, warning, createDocumentationMessageGenerator, createSendEventForFacet, isEqual, noop } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'hierarchical-menu',\n  connector: true\n});\nvar DEFAULT_SORT = ['name:asc'];\n/**\n * **HierarchicalMenu** connector provides the logic to build a custom widget\n * that will give the user the ability to explore facets in a tree-like structure.\n *\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two\n * levels deep.\n *\n * @type {Connector}\n * @param {function(HierarchicalMenuRenderingOptions, boolean)} renderFn Rendering function for the custom **HierarchicalMenu** widget.\n * @param {function} unmountFn Unmount function called when the widget is disposed.\n * @return {function(CustomHierarchicalMenuWidgetParams)} Re-usable widget factory for a custom **HierarchicalMenu** widget.\n */\nvar connectHierarchicalMenu = function connectHierarchicalMenu(renderFn) {\n  var unmountFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n  checkRendering(renderFn, withUsage());\n  return function (widgetParams) {\n    var _ref = widgetParams || {},\n      attributes = _ref.attributes,\n      _ref$separator = _ref.separator,\n      separator = _ref$separator === void 0 ? ' > ' : _ref$separator,\n      _ref$rootPath = _ref.rootPath,\n      rootPath = _ref$rootPath === void 0 ? null : _ref$rootPath,\n      _ref$showParentLevel = _ref.showParentLevel,\n      showParentLevel = _ref$showParentLevel === void 0 ? true : _ref$showParentLevel,\n      _ref$limit = _ref.limit,\n      limit = _ref$limit === void 0 ? 10 : _ref$limit,\n      _ref$showMore = _ref.showMore,\n      showMore = _ref$showMore === void 0 ? false : _ref$showMore,\n      _ref$showMoreLimit = _ref.showMoreLimit,\n      showMoreLimit = _ref$showMoreLimit === void 0 ? 20 : _ref$showMoreLimit,\n      _ref$sortBy = _ref.sortBy,\n      sortBy = _ref$sortBy === void 0 ? DEFAULT_SORT : _ref$sortBy,\n      _ref$transformItems = _ref.transformItems,\n      transformItems = _ref$transformItems === void 0 ? function (items) {\n        return items;\n      } : _ref$transformItems;\n    if (!attributes || !Array.isArray(attributes) || attributes.length === 0) {\n      throw new Error(withUsage('The `attributes` option expects an array of strings.'));\n    }\n    if (showMore === true && showMoreLimit <= limit) {\n      throw new Error(withUsage('The `showMoreLimit` option must be greater than `limit`.'));\n    }\n    // we need to provide a hierarchicalFacet name for the search state\n    // so that we can always map $hierarchicalFacetName => real attributes\n    // we use the first attribute name\n    var _attributes = _slicedToArray(attributes, 1),\n      hierarchicalFacetName = _attributes[0];\n    var sendEvent;\n\n    // Provide the same function to the `renderFn` so that way the user\n    // has to only bind it once when `isFirstRendering` for instance\n    var toggleShowMore = function toggleShowMore() {};\n    function cachedToggleShowMore() {\n      toggleShowMore();\n    }\n    var _refine;\n    var isShowingMore = false;\n    function createToggleShowMore(renderOptions, widget) {\n      return function () {\n        isShowingMore = !isShowingMore;\n        widget.render(renderOptions);\n      };\n    }\n    function getLimit() {\n      return isShowingMore ? showMoreLimit : limit;\n    }\n    function _prepareFacetValues(facetValues) {\n      return facetValues.slice(0, getLimit()).map(function (_ref2) {\n        var label = _ref2.name,\n          value = _ref2.escapedValue,\n          data = _ref2.data,\n          path = _ref2.path,\n          subValue = _objectWithoutProperties(_ref2, _excluded);\n        var item = _objectSpread(_objectSpread({}, subValue), {}, {\n          value: value,\n          label: label,\n          data: null\n        });\n        if (Array.isArray(data)) {\n          item.data = _prepareFacetValues(data);\n        }\n        return item;\n      });\n    }\n    return {\n      $$type: 'ais.hierarchicalMenu',\n      init: function init(initOptions) {\n        var instantSearchInstance = initOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(initOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), true);\n      },\n      render: function render(renderOptions) {\n        var instantSearchInstance = renderOptions.instantSearchInstance;\n        toggleShowMore = createToggleShowMore(renderOptions, this);\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(renderOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), false);\n      },\n      dispose: function dispose(_ref3) {\n        var state = _ref3.state;\n        unmountFn();\n        return state.removeHierarchicalFacet(hierarchicalFacetName).setQueryParameter('maxValuesPerFacet', undefined);\n      },\n      getRenderState: function getRenderState(renderState, renderOptions) {\n        return _objectSpread(_objectSpread({}, renderState), {}, {\n          hierarchicalMenu: _objectSpread(_objectSpread({}, renderState.hierarchicalMenu), {}, _defineProperty({}, hierarchicalFacetName, this.getWidgetRenderState(renderOptions)))\n        });\n      },\n      getWidgetRenderState: function getWidgetRenderState(_ref4) {\n        var _this = this;\n        var results = _ref4.results,\n          state = _ref4.state,\n          createURL = _ref4.createURL,\n          instantSearchInstance = _ref4.instantSearchInstance,\n          helper = _ref4.helper;\n        var items = [];\n        var canToggleShowMore = false;\n\n        // Bind createURL to this specific attribute\n        var _createURL = function _createURL(facetValue) {\n          return createURL(function (uiState) {\n            return _this.getWidgetUiState(uiState, {\n              searchParameters: state.resetPage().toggleFacetRefinement(hierarchicalFacetName, facetValue),\n              helper: helper\n            });\n          });\n        };\n        if (!sendEvent) {\n          sendEvent = createSendEventForFacet({\n            instantSearchInstance: instantSearchInstance,\n            helper: helper,\n            attribute: function attribute(facetValue) {\n              var index = facetValue.split(separator).length - 1;\n              return attributes[index];\n            },\n            widgetType: this.$$type\n          });\n        }\n        if (!_refine) {\n          _refine = function _refine(facetValue) {\n            sendEvent('click:internal', facetValue);\n            helper.toggleFacetRefinement(hierarchicalFacetName, facetValue).search();\n          };\n        }\n        if (results) {\n          var facetValues = results.getFacetValues(hierarchicalFacetName, {\n            sortBy: sortBy,\n            facetOrdering: sortBy === DEFAULT_SORT\n          });\n          var facetItems = facetValues && !Array.isArray(facetValues) && facetValues.data ? facetValues.data : [];\n\n          // If the limit is the max number of facet retrieved it is impossible to know\n          // if the facets are exhaustive. The only moment we are sure it is exhaustive\n          // is when it is strictly under the number requested unless we know that another\n          // widget has requested more values (maxValuesPerFacet > getLimit()).\n          // Because this is used for making the search of facets unable or not, it is important\n          // to be conservative here.\n          var hasExhaustiveItems = (state.maxValuesPerFacet || 0) > getLimit() ? facetItems.length <= getLimit() : facetItems.length < getLimit();\n          canToggleShowMore = showMore && (isShowingMore || !hasExhaustiveItems);\n          items = transformItems(_prepareFacetValues(facetItems), {\n            results: results\n          });\n        }\n        return {\n          items: items,\n          refine: _refine,\n          canRefine: items.length > 0,\n          createURL: _createURL,\n          sendEvent: sendEvent,\n          widgetParams: widgetParams,\n          isShowingMore: isShowingMore,\n          toggleShowMore: cachedToggleShowMore,\n          canToggleShowMore: canToggleShowMore\n        };\n      },\n      getWidgetUiState: function getWidgetUiState(uiState, _ref5) {\n        var searchParameters = _ref5.searchParameters;\n        var path = searchParameters.getHierarchicalFacetBreadcrumb(hierarchicalFacetName);\n        return removeEmptyRefinementsFromUiState(_objectSpread(_objectSpread({}, uiState), {}, {\n          hierarchicalMenu: _objectSpread(_objectSpread({}, uiState.hierarchicalMenu), {}, _defineProperty({}, hierarchicalFacetName, path))\n        }), hierarchicalFacetName);\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n        var uiState = _ref6.uiState;\n        var values = uiState.hierarchicalMenu && uiState.hierarchicalMenu[hierarchicalFacetName];\n        if (searchParameters.isConjunctiveFacet(hierarchicalFacetName) || searchParameters.isDisjunctiveFacet(hierarchicalFacetName)) {\n          process.env.NODE_ENV === 'development' ? warning(false, \"HierarchicalMenu: Attribute \\\"\".concat(hierarchicalFacetName, \"\\\" is already used by another widget applying conjunctive or disjunctive faceting.\\nAs this is not supported, please make sure to remove this other widget or this HierarchicalMenu widget will not work at all.\")) : void 0;\n          return searchParameters;\n        }\n        if (searchParameters.isHierarchicalFacet(hierarchicalFacetName)) {\n          var facet = searchParameters.getHierarchicalFacetByName(hierarchicalFacetName);\n          process.env.NODE_ENV === 'development' ? warning(isEqual(facet.attributes, attributes) && facet.separator === separator && facet.rootPath === rootPath, 'Using Breadcrumb and HierarchicalMenu on the same facet with different options overrides the configuration of the HierarchicalMenu.') : void 0;\n        }\n        var withFacetConfiguration = searchParameters.removeHierarchicalFacet(hierarchicalFacetName).addHierarchicalFacet({\n          name: hierarchicalFacetName,\n          attributes: attributes,\n          separator: separator,\n          rootPath: rootPath,\n          showParentLevel: showParentLevel\n        });\n        var currentMaxValuesPerFacet = withFacetConfiguration.maxValuesPerFacet || 0;\n        var nextMaxValuesPerFacet = Math.max(currentMaxValuesPerFacet, showMore ? showMoreLimit : limit);\n        var withMaxValuesPerFacet = withFacetConfiguration.setQueryParameter('maxValuesPerFacet', nextMaxValuesPerFacet);\n        if (!values) {\n          return withMaxValuesPerFacet.setQueryParameters({\n            hierarchicalFacetsRefinements: _objectSpread(_objectSpread({}, withMaxValuesPerFacet.hierarchicalFacetsRefinements), {}, _defineProperty({}, hierarchicalFacetName, []))\n          });\n        }\n        return withMaxValuesPerFacet.addHierarchicalFacetRefinement(hierarchicalFacetName, values.join(separator));\n      }\n    };\n  };\n};\nfunction removeEmptyRefinementsFromUiState(indexUiState, attribute) {\n  if (!indexUiState.hierarchicalMenu) {\n    return indexUiState;\n  }\n  if (!indexUiState.hierarchicalMenu[attribute] || indexUiState.hierarchicalMenu[attribute].length === 0) {\n    delete indexUiState.hierarchicalMenu[attribute];\n  }\n  if (Object.keys(indexUiState.hierarchicalMenu).length === 0) {\n    delete indexUiState.hierarchicalMenu;\n  }\n  return indexUiState;\n}\nexport default connectHierarchicalMenu;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}